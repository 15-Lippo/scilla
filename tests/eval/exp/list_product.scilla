let list_product = 
  fun (ls : List Int) => fun (acc : Int) =>
  let iter =
    fun (h : Int) => fun (res : Int) =>
      let zero = 0 in
      let b = builtin eq h zero in
      match b with
      | True => 0
      | False => builtin mul h res
      end
  in
  let rec_nat = @list_foldr Int Int in
  rec_nat iter acc ls    
in
let one = 1 in 
let two = 2 in
let three = 3 in

let nil = Nil in
let l1 = Cons {Int} three nil in
let l2 = Cons {Int} two l1 in
let l3 = Cons {Int} one l2 in

list_product l3 one